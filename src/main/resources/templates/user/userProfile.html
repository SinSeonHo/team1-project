<!DOCTYPE html>
<html lang="en" layout:decorate="~{layouts/layout}">
  <th:block layout:fragment="css">
    <link rel="stylesheet" th:href="@{/css/userProfile.css}">
  </th:block>

  <main layout:fragment="content">
    <div class="container py-5" style="max-width: 800px">
      <div class="row justify-content-center align-items-stretch">
        <h2 class="mb-5 text-center fw-bold" style="color: #fff; letter-spacing: 2px">프로필 정보</h2>
        <div class="row justify-content-center">
          <!-- 프로필 사진 & 버튼 -->
          <div class="col-md-4 d-flex flex-column align-items-center mb-4 mb-md-0">
            <!-- 동그란 프로필 이미지 -->
            <div class="mb-3">
              <img id="profile-img" th:src="@{${userProfileDTO.profileImageUrl}}" alt="프로필" class="rounded-circle shadow" style="width: 200px; height: 200px; object-fit: cover; border: 3px solid #277aff; background: #eee" />
              <img  />    
<script>
  document.getElementById("profile-img").src += "?t=" + Date.now();
</script>
            </div>

            <!-- 프로필 관련 버튼 -->
            <div class="d-flex flex-column w-100 px-4" style="gap: 8px">
              
              <button type="button"
                class="profile-btn profile-btn-lightgray"
                 th:onclick="|location.href='@{/user/modifyUserProfile(id=${userProfileDTO.id})}'|">
                수정
              </button>

            <button type="button" class="profile-btn profile-btn-danger">
              <a th:href="@{/user/delete(id=${userProfileDTO.id})}">회원탈퇴</a>
            </button>
            </div>
          </div>
          <!-- 정보 표시 블록 (readonly input) -->
          <div class="col-md-8">
            <div class="user-info-list mb-4">
              <div class="user-info-item">
                <label for="name" class="user-info-label">이름</label>
                <input type="text" class="form-control user-info-value" id="name" th:value="${userProfileDTO.name}?: ''" readonly />
              </div>
              <div class="user-info-item">
                <label for="nickname" class="user-info-label">닉네임</label>
                <input type="text" class="form-control user-info-value" id="nickname"th:value="${userProfileDTO.nickname}?:''" readonly />
              </div>
              <div class="user-info-item">
                <label for="userid" class="user-info-label">아이디</label>
                <input type="text" class="form-control user-info-value" id="userid"th:value="${userProfileDTO.id}" readonly />
              </div>
              <div class="user-info-item">
                <label for="email" class="user-info-label">이메일</label>
                <input type="email" class="form-control user-info-value" id="email"th:value="${userProfileDTO.email}?:'인증받지 않음'" readonly />
              </div>
              <div class="user-info-item">
                <label for="grade" class="user-info-label">마일리지 등급</label>
                <input type="text" class="form-control user-info-value" id="grade"th:value="${userProfileDTO.grade}?:''" readonly />
              </div>
            </div>
            <!-- 필요하다면 하단에 버튼 추가 가능 -->
          </div>
        </div>
        <section class="user-gallery-section mt-4" th:unless="${images.size() == 0}">
  <h3 class="gallery-title mb-3" style="color: #fff; font-size: 1.2rem;">좋아하는 영화/게임들</h3>
  <div class="user-gallery-grid">
    <img th:each="image, iterStat : ${images}" th:if="${iterStat.index < 4}" th:src="@{${image.path}}" alt="gallery-img" class="gallery-img" />

    
  </div>
</section>

      </div>
    </div>
  </main>
  <th:block layout:fragment="script">
    <script th:src="@{/js/userProfile.js}"></script>
  </th:block>
</html>
